<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
Copyright (c) 2004-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">{- |
   Module     : System.IO.Utils
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt;
   Stability  : provisional
   Portability: portable
-}</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span class="hs-special">(</span><span class="hs-comment">-- * Entire File Handle Utilities</span><span>
</span><a name="line-20"></a><span>                       </span><span class="hs-comment">-- ** Opened Handle Data Copying</span><span>
</span><a name="line-21"></a><span>                       </span><a href="System.IO.Utils.html#hCopy" xdef=""><span class="hs-identifier hs-var">hCopy</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Utils.html#hCopyProgress" xdef=""><span class="hs-identifier hs-var">hCopyProgress</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Utils.html#hLineCopy" xdef=""><span class="hs-identifier hs-var">hLineCopy</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Utils.html#lineCopy" xdef=""><span class="hs-identifier hs-var">lineCopy</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>                       </span><span class="hs-comment">-- ** Disk File Data Copying</span><span>
</span><a name="line-23"></a><span>                       </span><a href="System.IO.Utils.html#copyFileLinesToFile" xdef=""><span class="hs-identifier hs-var">copyFileLinesToFile</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>                       </span><span class="hs-comment">-- * Line Processing Utilities</span><span>
</span><a name="line-25"></a><span>                       </span><a href="System.IO.Utils.html#hPutStrLns" xdef=""><span class="hs-identifier hs-var">hPutStrLns</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Utils.html#hGetLines" xdef=""><span class="hs-identifier hs-var">hGetLines</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                       </span><span class="hs-comment">-- * Lazy Interaction</span><span>
</span><a name="line-27"></a><span>                       </span><span class="hs-comment">-- ** Character-based</span><span>
</span><a name="line-28"></a><span>                       </span><a href="System.IO.Utils.html#hInteract" xdef=""><span class="hs-identifier hs-var">hInteract</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>                       </span><span class="hs-comment">-- ** Line-based</span><span>
</span><a name="line-30"></a><span>                       </span><a href="System.IO.Utils.html#hLineInteract" xdef=""><span class="hs-identifier hs-var">hLineInteract</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Utils.html#lineInteract" xdef=""><span class="hs-identifier hs-var">lineInteract</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>                       </span><span class="hs-comment">-- ** Misc. Lazy</span><span>
</span><a name="line-32"></a><span>                       </span><a href="System.IO.Utils.html#lazyMapM" xdef=""><span class="hs-identifier hs-var">lazyMapM</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>                       </span><span class="hs-comment">-- * Optimizations</span><span>
</span><a name="line-34"></a><span>                       </span><a href="System.IO.Utils.html#optimizeForBatch" xdef=""><span class="hs-identifier hs-var">optimizeForBatch</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Utils.html#optimizeForInteraction" xdef=""><span class="hs-identifier hs-var">optimizeForInteraction</span></a><span>
</span><a name="line-35"></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span> </span><span class="hs-special">(</span><a xdef="imported from System.IO.Unsafe" xref="base:GHC.IO.unsafeInterleaveIO"><span class="hs-identifier hs-var">unsafeInterleaveIO</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><a xdef="imported from Data.List" xref="base:Data.OldList.genericLength"><span class="hs-identifier hs-var">genericLength</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="System.IO.HVIO.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">HVIO</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">{- | Given a list of strings, output a line containing each item, adding
newlines as appropriate.  The list is not expected to have newlines already.
-}</span><span>
</span><a name="line-45"></a><span class="hs-identifier">hPutStrLns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468219"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627468219"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><a name="hPutStrLns"><a href="System.IO.Utils.html#hPutStrLns" xdef=""><span class="hs-identifier">hPutStrLns</span></a></a><span> </span><a name="local-1627468220"><a href="#local-1627468220"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="base:Data.Foldable.mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.IO.HVIO.html#vPutStrLn" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vPutStrLn</span></a><span> </span><a href="#local-1627468220"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">{- | Given a handle, returns a list of all the lines in that handle.
Thanks to lazy evaluation, this list does not have to be read all at once.

Combined with 'hPutStrLns', this can make a powerful way to develop
filters.  See the 'lineInteract' function for more on that concept.

Example:

&gt; main = do
&gt;        l &lt;- hGetLines stdin
&gt;        hPutStrLns stdout $ filter (startswith &quot;1&quot;) l

-}</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- FIXME: does hGetContents h &gt;&gt;= return . lines not work?</span><span>
</span><a name="line-63"></a><span class="hs-identifier">hGetLines</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468218"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627468218"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span>
</span><a name="line-64"></a><a name="hGetLines"><a href="System.IO.Utils.html#hGetLines" xdef=""><span class="hs-identifier">hGetLines</span></a></a><span> </span><a name="local-1627468221"><a href="#local-1627468221"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from System.IO.Unsafe" xref="base:GHC.IO.unsafeInterleaveIO"><span class="hs-identifier hs-var">unsafeInterleaveIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-65"></a><span>                                  </span><a name="local-1627468222"><a href="#local-1627468222"><span class="hs-identifier">ieof</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVIO.html#vIsEOF" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vIsEOF</span></a><span> </span><a href="#local-1627468221"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-66"></a><span>                                  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-1627468222"><span class="hs-identifier hs-var">ieof</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>                                     </span><span class="hs-keyword">then</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>                                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-69"></a><span>                                          </span><a name="local-1627468223"><a href="#local-1627468223"><span class="hs-identifier">line</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVIO.html#vGetLine" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vGetLine</span></a><span> </span><a href="#local-1627468221"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-70"></a><span>                                          </span><a name="local-1627468224"><a href="#local-1627468224"><span class="hs-identifier">remainder</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.Utils.html#hGetLines" xdef=""><span class="hs-identifier hs-var">hGetLines</span></a><span> </span><a href="#local-1627468221"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-71"></a><span>                                          </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627468223"><span class="hs-identifier hs-var">line</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627468224"><span class="hs-identifier hs-var">remainder</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">{- | This is similar to the built-in 'System.IO.interact', but works
on any handle, not just stdin and stdout.

In other words:

&gt; interact = hInteract stdin stdout
-}</span><span>
</span><a name="line-81"></a><span class="hs-identifier">hInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468216"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468217"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627468216"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627468217"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><a name="hInteract"><a href="System.IO.Utils.html#hInteract" xdef=""><span class="hs-identifier">hInteract</span></a></a><span> </span><a name="local-1627468225"><a href="#local-1627468225"><span class="hs-identifier">finput</span></a></a><span> </span><a name="local-1627468226"><a href="#local-1627468226"><span class="hs-identifier">foutput</span></a></a><span> </span><a name="local-1627468227"><a href="#local-1627468227"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-83"></a><span>                                </span><a name="local-1627468228"><a href="#local-1627468228"><span class="hs-identifier">content</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVIO.html#vGetContents" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vGetContents</span></a><span> </span><a href="#local-1627468225"><span class="hs-identifier hs-var">finput</span></a><span>
</span><a name="line-84"></a><span>                                </span><a href="System.IO.HVIO.html#vPutStr" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vPutStr</span></a><span> </span><a href="#local-1627468226"><span class="hs-identifier hs-var">foutput</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627468227"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-1627468228"><span class="hs-identifier hs-var">content</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">{- | Line-based interaction.  This is similar to wrapping your
interact functions with 'lines' and 'unlines'.  This equality holds:

&gt; lineInteract = hLineInteract stdin stdout

Here's an example:

&gt; main = lineInteract (filter (startswith &quot;1&quot;))

This will act as a simple version of grep -- all lines that start with 1
will be displayed; all others will be ignored.
-}</span><span>
</span><a name="line-98"></a><span class="hs-identifier">lineInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><a name="lineInteract"><a href="System.IO.Utils.html#lineInteract" xdef=""><span class="hs-identifier">lineInteract</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Utils.html#hLineInteract" xdef=""><span class="hs-identifier hs-var">hLineInteract</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdin"><span class="hs-identifier hs-var">stdin</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdout"><span class="hs-identifier hs-var">stdout</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">{- | Line-based interaction over arbitrary handles.  This is similar
to wrapping hInteract with 'lines' and 'unlines'.

One could view this function like this:

&gt; hLineInteract finput foutput func =
&gt;     let newf = unlines . func . lines in
&gt;         hInteract finput foutput newf

Though the actual implementation is this for efficiency:

&gt; hLineInteract finput foutput func =
&gt;     do
&gt;     lines &lt;- hGetLines finput
&gt;     hPutStrLns foutput (func lines)
-}</span><span>
</span><a name="line-117"></a><span class="hs-identifier">hLineInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468214"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468215"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627468214"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627468215"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="hLineInteract"><a href="System.IO.Utils.html#hLineInteract" xdef=""><span class="hs-identifier">hLineInteract</span></a></a><span> </span><a name="local-1627468229"><a href="#local-1627468229"><span class="hs-identifier">finput</span></a></a><span> </span><a name="local-1627468230"><a href="#local-1627468230"><span class="hs-identifier">foutput</span></a></a><span> </span><a name="local-1627468231"><a href="#local-1627468231"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-keyword">do</span><span>
</span><a name="line-120"></a><span>    </span><a name="local-1627468232"><a href="#local-1627468232"><span class="hs-identifier">lines</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.Utils.html#hGetLines" xdef=""><span class="hs-identifier hs-var">hGetLines</span></a><span> </span><a href="#local-1627468229"><span class="hs-identifier hs-var">finput</span></a><span>
</span><a name="line-121"></a><span>    </span><a href="System.IO.Utils.html#hPutStrLns" xdef=""><span class="hs-identifier hs-var">hPutStrLns</span></a><span> </span><a href="#local-1627468230"><span class="hs-identifier hs-var">foutput</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627468231"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-1627468232"><span class="hs-identifier hs-var">lines</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-comment">{- | Copies from one handle to another in raw mode (using
hGetContents).
-}</span><span>
</span><a name="line-126"></a><span class="hs-identifier">hCopy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468212"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468213"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627468212"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627468213"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><a name="hCopy"><a href="System.IO.Utils.html#hCopy" xdef=""><span class="hs-identifier">hCopy</span></a></a><span> </span><a name="local-1627468233"><a href="#local-1627468233"><span class="hs-identifier">hin</span></a></a><span> </span><a name="local-1627468234"><a href="#local-1627468234"><span class="hs-identifier">hout</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-128"></a><span>                 </span><a name="local-1627468235"><a href="#local-1627468235"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVIO.html#vGetContents" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vGetContents</span></a><span> </span><a href="#local-1627468233"><span class="hs-identifier hs-var">hin</span></a><span>
</span><a name="line-129"></a><span>                 </span><a href="System.IO.HVIO.html#vPutStr" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vPutStr</span></a><span> </span><a href="#local-1627468234"><span class="hs-identifier hs-var">hout</span></a><span> </span><a href="#local-1627468235"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">{- | Copies from one handle to another in raw mode (using hGetContents).
Takes a function to provide progress updates to the user.
-}</span><span>
</span><a name="line-134"></a><span class="hs-identifier">hCopyProgress</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468209"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468210"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Real.Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-1627468211"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-135"></a><span>                    </span><a href="#local-1627468209"><span class="hs-identifier hs-type">b</span></a><span>        </span><span class="hs-comment">-- ^ Input handle</span><span>
</span><a name="line-136"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627468210"><span class="hs-identifier hs-type">c</span></a><span>              </span><span class="hs-comment">-- ^ Output handle</span><span>
</span><a name="line-137"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Base.Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627468211"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="integer-gmp:GHC.Integer.Type.Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Bool"><span class="hs-identifier hs-type">Bool</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Progress function -- the bool is always False unless this is the final call</span><span>
</span><a name="line-138"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span>                 </span><span class="hs-comment">-- Block size</span><span>
</span><a name="line-139"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627468211"><span class="hs-identifier hs-type">a</span></a><span>             </span><span class="hs-comment">-- Estimated file size (passed to func)</span><span>
</span><a name="line-140"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a xdef="imported from Prelude" xref="integer-gmp:GHC.Integer.Type.Integer"><span class="hs-identifier hs-type">Integer</span></a><span>                </span><span class="hs-comment">-- Number of bytes copied</span><span>
</span><a name="line-141"></a><a name="hCopyProgress"><a href="System.IO.Utils.html#hCopyProgress" xdef=""><span class="hs-identifier">hCopyProgress</span></a></a><span> </span><a name="local-1627468236"><a href="#local-1627468236"><span class="hs-identifier">hin</span></a></a><span> </span><a name="local-1627468237"><a href="#local-1627468237"><span class="hs-identifier">hout</span></a></a><span> </span><a name="local-1627468238"><a href="#local-1627468238"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-1627468239"><a href="#local-1627468239"><span class="hs-identifier">bsize</span></a></a><span> </span><a name="local-1627468240"><a href="#local-1627468240"><span class="hs-identifier">estsize</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">copyFunc</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="integer-gmp:GHC.Integer.Type.Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a xdef="imported from Prelude" xref="integer-gmp:GHC.Integer.Type.Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-143"></a><span>        </span><a name="local-1627468241"><a href="#local-1627468241"><span class="hs-identifier">copyFunc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1627468242"><a href="#local-1627468242"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627468242"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-144"></a><span>        </span><span class="hs-identifier">copyFunc</span><span> </span><a name="local-1627468243"><a href="#local-1627468243"><span class="hs-identifier">indata</span></a></a><span> </span><a name="local-1627468244"><a href="#local-1627468244"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-145"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-1627468245"><a href="#local-1627468245"><span class="hs-identifier">block</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.List.take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1627468239"><span class="hs-identifier hs-var">bsize</span></a><span> </span><a href="#local-1627468243"><span class="hs-identifier hs-var">indata</span></a><span>
</span><a name="line-146"></a><span>                </span><a name="local-1627468246"><a href="#local-1627468246"><span class="hs-identifier">remainder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.List.drop"><span class="hs-identifier hs-var">drop</span></a><span> </span><a href="#local-1627468239"><span class="hs-identifier hs-var">bsize</span></a><span> </span><a href="#local-1627468243"><span class="hs-identifier hs-var">indata</span></a><span>
</span><a name="line-147"></a><span>                </span><a name="local-1627468247"><a href="#local-1627468247"><span class="hs-identifier">newcount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627468244"><span class="hs-identifier hs-var">count</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.+"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Data.List" xref="base:Data.OldList.genericLength"><span class="hs-identifier hs-var">genericLength</span></a><span> </span><a href="#local-1627468245"><span class="hs-identifier hs-var">block</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>                </span><span class="hs-keyword">in</span><span>
</span><a name="line-149"></a><span>                </span><span class="hs-keyword">do</span><span>
</span><a name="line-150"></a><span>                </span><a href="System.IO.HVIO.html#vPutStr" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vPutStr</span></a><span> </span><a href="#local-1627468237"><span class="hs-identifier hs-var">hout</span></a><span> </span><a href="#local-1627468245"><span class="hs-identifier hs-var">block</span></a><span>
</span><a name="line-151"></a><span>                </span><a href="#local-1627468238"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-1627468240"><span class="hs-identifier hs-var">estsize</span></a><span> </span><a href="#local-1627468244"><span class="hs-identifier hs-var">count</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-152"></a><span>                </span><a href="#local-1627468241"><span class="hs-identifier hs-var">copyFunc</span></a><span> </span><a href="#local-1627468246"><span class="hs-identifier hs-var">remainder</span></a><span> </span><a href="#local-1627468247"><span class="hs-identifier hs-var">newcount</span></a><span>
</span><a name="line-153"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-154"></a><span>        </span><span class="hs-keyword">do</span><span>
</span><a name="line-155"></a><span>        </span><a name="local-1627468248"><a href="#local-1627468248"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVIO.html#vGetContents" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-var">vGetContents</span></a><span> </span><a href="#local-1627468236"><span class="hs-identifier hs-var">hin</span></a><span>
</span><a name="line-156"></a><span>        </span><a name="local-1627468249"><a href="#local-1627468249"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627468241"><span class="hs-identifier hs-var">copyFunc</span></a><span> </span><a href="#local-1627468248"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-157"></a><span>        </span><a href="#local-1627468238"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-1627468240"><span class="hs-identifier hs-var">estsize</span></a><span> </span><a href="#local-1627468249"><span class="hs-identifier hs-var">bytes</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.True"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-158"></a><span>        </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627468249"><span class="hs-identifier hs-var">bytes</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">{- | Copies from one handle to another in text mode (with lines).
Like 'hBlockCopy', this implementation is nice:

&gt; hLineCopy hin hout = hLineInteract hin hout id
-}</span><span>
</span><a name="line-165"></a><span class="hs-identifier">hLineCopy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468207"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO" xdef="imported from System.IO.HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-1627468208"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627468207"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627468208"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><a name="hLineCopy"><a href="System.IO.Utils.html#hLineCopy" xdef=""><span class="hs-identifier">hLineCopy</span></a></a><span> </span><a name="local-1627468250"><a href="#local-1627468250"><span class="hs-identifier">hin</span></a></a><span> </span><a name="local-1627468251"><a href="#local-1627468251"><span class="hs-identifier">hout</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Utils.html#hLineInteract" xdef=""><span class="hs-identifier hs-var">hLineInteract</span></a><span> </span><a href="#local-1627468250"><span class="hs-identifier hs-var">hin</span></a><span> </span><a href="#local-1627468251"><span class="hs-identifier hs-var">hout</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.id"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">{- | Copies from 'stdin' to 'stdout' using lines.  An alias for 'hLineCopy'
over 'stdin' and 'stdout'. -}</span><span>
</span><a name="line-170"></a><span class="hs-identifier">lineCopy</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><a name="lineCopy"><a href="System.IO.Utils.html#lineCopy" xdef=""><span class="hs-identifier">lineCopy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Utils.html#hLineCopy" xdef=""><span class="hs-identifier hs-var">hLineCopy</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdin"><span class="hs-identifier hs-var">stdin</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdout"><span class="hs-identifier hs-var">stdout</span></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">{- | Copies one filename to another in text mode.

Please note that the Unix permission bits are set at a default; you may
need to adjust them after the copy yourself.

This function is implemented using 'hLineCopy' internally. -}</span><span>
</span><a name="line-179"></a><span class="hs-identifier">copyFileLinesToFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.IO.FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.IO.FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><a name="copyFileLinesToFile"><a href="System.IO.Utils.html#copyFileLinesToFile" xdef=""><span class="hs-identifier">copyFileLinesToFile</span></a></a><span> </span><a name="local-1627468252"><a href="#local-1627468252"><span class="hs-identifier">infn</span></a></a><span> </span><a name="local-1627468253"><a href="#local-1627468253"><span class="hs-identifier">outfn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-181"></a><span>                                 </span><a name="local-1627468254"><a href="#local-1627468254"><span class="hs-identifier">hin</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.openFile"><span class="hs-identifier hs-var">openFile</span></a><span> </span><a href="#local-1627468252"><span class="hs-identifier hs-var">infn</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.IOMode.ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a><span>
</span><a name="line-182"></a><span>                                 </span><a name="local-1627468255"><a href="#local-1627468255"><span class="hs-identifier">hout</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.openFile"><span class="hs-identifier hs-var">openFile</span></a><span> </span><a href="#local-1627468253"><span class="hs-identifier hs-var">outfn</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.IOMode.WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a><span>
</span><a name="line-183"></a><span>                                 </span><a href="System.IO.Utils.html#hLineCopy" xdef=""><span class="hs-identifier hs-var">hLineCopy</span></a><span> </span><a href="#local-1627468254"><span class="hs-identifier hs-var">hin</span></a><span> </span><a href="#local-1627468255"><span class="hs-identifier hs-var">hout</span></a><span>
</span><a name="line-184"></a><span>                                 </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.hClose"><span class="hs-identifier hs-var">hClose</span></a><span> </span><a href="#local-1627468254"><span class="hs-identifier hs-var">hin</span></a><span>
</span><a name="line-185"></a><span>                                 </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.hClose"><span class="hs-identifier hs-var">hClose</span></a><span> </span><a href="#local-1627468255"><span class="hs-identifier hs-var">hout</span></a><span>
</span><a name="line-186"></a><span>                                 </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">{- | Sets stdin and stdout to be block-buffered.  This can save a huge amount
of system resources since far fewer syscalls are made, and can make programs
run much faster. -}</span><span>
</span><a name="line-191"></a><span class="hs-identifier">optimizeForBatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><a name="optimizeForBatch"><a href="System.IO.Utils.html#optimizeForBatch" xdef=""><span class="hs-identifier">optimizeForBatch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-193"></a><span>                   </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.hSetBuffering"><span class="hs-identifier hs-var">hSetBuffering</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdin"><span class="hs-identifier hs-var">stdin</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.Types.BlockBuffering"><span class="hs-identifier hs-var">BlockBuffering</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Base.Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-number">4096</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>                   </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.hSetBuffering"><span class="hs-identifier hs-var">hSetBuffering</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdout"><span class="hs-identifier hs-var">stdout</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.Types.BlockBuffering"><span class="hs-identifier hs-var">BlockBuffering</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Base.Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-number">4096</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">{- | Sets stdin and stdout to be line-buffered.  This saves resources
on stdout, but not many on stdin, since it it still looking for newlines. -}</span><span>
</span><a name="line-198"></a><span class="hs-identifier">optimizeForInteraction</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><a name="optimizeForInteraction"><a href="System.IO.Utils.html#optimizeForInteraction" xdef=""><span class="hs-identifier">optimizeForInteraction</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-200"></a><span>                         </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.hSetBuffering"><span class="hs-identifier hs-var">hSetBuffering</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdin"><span class="hs-identifier hs-var">stdin</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.Types.LineBuffering"><span class="hs-identifier hs-var">LineBuffering</span></a><span>
</span><a name="line-201"></a><span>                         </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.hSetBuffering"><span class="hs-identifier hs-var">hSetBuffering</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.FD.stdout"><span class="hs-identifier hs-var">stdout</span></a><span> </span><a xdef="imported from System.IO" xref="base:GHC.IO.Handle.Types.LineBuffering"><span class="hs-identifier hs-var">LineBuffering</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">{- | Applies a given function to every item in a list, and returns
the new list.  Unlike the system\'s mapM, items are evaluated lazily. -}</span><span>
</span><a name="line-205"></a><span class="hs-identifier">lazyMapM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627468205"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="#local-1627468206"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627468205"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627468206"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-206"></a><a name="lazyMapM"><a href="System.IO.Utils.html#lazyMapM" xdef=""><span class="hs-identifier">lazyMapM</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-207"></a><span class="hs-identifier">lazyMapM</span><span> </span><a name="local-1627468256"><a href="#local-1627468256"><span class="hs-identifier">conv</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627468257"><a href="#local-1627468257"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1627468258"><a href="#local-1627468258"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-1627468259"><a href="#local-1627468259"><span class="hs-identifier">this</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627468256"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="#local-1627468257"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-209"></a><span>       </span><a name="local-1627468260"><a href="#local-1627468260"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a xdef="imported from System.IO.Unsafe" xref="base:GHC.IO.unsafeInterleaveIO"><span class="hs-identifier hs-var">unsafeInterleaveIO</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.IO.Utils.html#lazyMapM" xdef=""><span class="hs-identifier hs-var">lazyMapM</span></a><span> </span><a href="#local-1627468256"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="#local-1627468258"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-210"></a><span>       </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627468259"><span class="hs-identifier hs-var">this</span></a><span class="hs-glyph">:</span><a href="#local-1627468260"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">)</span><span>
</span><a name="line-211"></a></pre></body></html>