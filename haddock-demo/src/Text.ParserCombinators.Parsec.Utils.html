<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- arch-tag: Parsec utilities
Copyright (c) 2004-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">{- |
   Module     : Text.ParserCombinators.Parsec.Utils
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt; 
   Stability  : provisional
   Portability: portable

Written by John Goerzen, jgoerzen\@complete.org

-}</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">ParserCombinators</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span class="hs-special">(</span><span class="hs-comment">-- * Generalized Utilities</span><span>
</span><a name="line-23"></a><span>                       </span><span class="hs-comment">-- | These functions are generalized versions of</span><span>
</span><a name="line-24"></a><span>                       </span><span class="hs-comment">-- ones you might see in the Char parser.</span><span>
</span><a name="line-25"></a><span>                       </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedToken" xdef=""><span class="hs-identifier hs-type">GeneralizedToken</span></a><span class="hs-special">,</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                       </span><a href="Text.ParserCombinators.Parsec.Utils.html#togtok" xdef=""><span class="hs-identifier hs-var">togtok</span></a><span class="hs-special">,</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#tokeng" xdef=""><span class="hs-identifier hs-var">tokeng</span></a><span class="hs-special">,</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#satisfyg" xdef=""><span class="hs-identifier hs-var">satisfyg</span></a><span class="hs-special">,</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#oneOfg" xdef=""><span class="hs-identifier hs-var">oneOfg</span></a><span class="hs-special">,</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#noneOfg" xdef=""><span class="hs-identifier hs-var">noneOfg</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>                       </span><a href="Text.ParserCombinators.Parsec.Utils.html#specificg" xdef=""><span class="hs-identifier hs-var">specificg</span></a><span class="hs-special">,</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#allg" xdef=""><span class="hs-identifier hs-var">allg</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>                       </span><span class="hs-comment">-- * Other Utilities</span><span>
</span><a name="line-29"></a><span>                       </span><a href="Text.ParserCombinators.Parsec.Utils.html#notMatching" xdef=""><span class="hs-identifier hs-var">notMatching</span></a><span>
</span><a name="line-30"></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">ParserCombinators</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">type</span><span> </span><a name="GeneralizedToken"><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedToken" xdef=""><span class="hs-identifier">GeneralizedToken</span></a></a><span> </span><a name="local-1627459280"><a href="#local-1627459280"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Pos.SourcePos"><span class="hs-identifier hs-type">SourcePos</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627459280"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">type</span><span> </span><a name="GeneralizedTokenParser"><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier">GeneralizedTokenParser</span></a></a><span> </span><a name="local-1627459277"><a href="#local-1627459277"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627459278"><a href="#local-1627459278"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-1627459279"><a href="#local-1627459279"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedToken" xdef=""><span class="hs-identifier hs-type">GeneralizedToken</span></a><span> </span><a href="#local-1627459277"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627459278"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627459279"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">{- | Generate (return) a 'GeneralizedToken'. -}</span><span>
</span><a name="line-38"></a><span class="hs-identifier">togtok</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627459297"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627459298"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627459299"><span class="hs-identifier hs-type">st</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedToken" xdef=""><span class="hs-identifier hs-type">GeneralizedToken</span></a><span> </span><a href="#local-1627459297"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><a name="togtok"><a href="Text.ParserCombinators.Parsec.Utils.html#togtok" xdef=""><span class="hs-identifier">togtok</span></a></a><span> </span><a name="local-1627459300"><a href="#local-1627459300"><span class="hs-identifier">tok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-40"></a><span>              </span><a name="local-1627459301"><a href="#local-1627459301"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.getPosition"><span class="hs-identifier hs-var">getPosition</span></a><span>
</span><a name="line-41"></a><span>              </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627459301"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627459300"><span class="hs-identifier hs-var">tok</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">{- | Retrieve the next token from a 'GeneralizedToken' stream.
   The given function should return the value to use, or Nothing
   to cause an error. -}</span><span>
</span><a name="line-46"></a><span class="hs-identifier">tokeng</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Show.Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-1627459294"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627459294"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627459295"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span> </span><a href="#local-1627459294"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459296"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627459295"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-47"></a><a name="tokeng"><a href="Text.ParserCombinators.Parsec.Utils.html#tokeng" xdef=""><span class="hs-identifier">tokeng</span></a></a><span> </span><a name="local-1627459302"><a href="#local-1627459302"><span class="hs-identifier">test</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-48"></a><span>    </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.token"><span class="hs-identifier hs-var">token</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Show.show"><span class="hs-identifier hs-var">show</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.."><span class="hs-operator hs-var">.</span></a><span> </span><a xdef="imported from Prelude" xref="base:Data.Tuple.snd"><span class="hs-identifier hs-var">snd</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:Data.Tuple.fst"><span class="hs-identifier hs-var">fst</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627459302"><span class="hs-identifier hs-var">test</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.."><span class="hs-operator hs-var">.</span></a><span> </span><a xdef="imported from Prelude" xref="base:Data.Tuple.snd"><span class="hs-identifier hs-var">snd</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">{- | A shortcut to 'tokeng'; the test here is just a function that returns
a Bool.  If the result is true; return that value -- otherwise, an error.
-}</span><span>
</span><a name="line-53"></a><span class="hs-identifier">satisfyg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Show.Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-1627459292"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627459292"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span> </span><a href="#local-1627459292"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459293"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627459292"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-54"></a><a name="satisfyg"><a href="Text.ParserCombinators.Parsec.Utils.html#satisfyg" xdef=""><span class="hs-identifier">satisfyg</span></a></a><span> </span><a name="local-1627459303"><a href="#local-1627459303"><span class="hs-identifier">test</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#tokeng" xdef=""><span class="hs-identifier hs-var">tokeng</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627459304"><a href="#local-1627459304"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627459303"><span class="hs-identifier hs-var">test</span></a><span> </span><a href="#local-1627459304"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627459304"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">{- | Matches one item in a list and returns it. -}</span><span>
</span><a name="line-57"></a><span class="hs-identifier">oneOfg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-1627459290"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Show.Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-1627459290"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627459290"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span> </span><a href="#local-1627459290"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459291"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627459290"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-58"></a><a name="oneOfg"><a href="Text.ParserCombinators.Parsec.Utils.html#oneOfg" xdef=""><span class="hs-identifier">oneOfg</span></a></a><span> </span><a name="local-1627459305"><a href="#local-1627459305"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#satisfyg" xdef=""><span class="hs-identifier hs-var">satisfyg</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627459306"><a href="#local-1627459306"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:Data.Foldable.elem"><span class="hs-identifier hs-var">elem</span></a><span> </span><a href="#local-1627459306"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627459305"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{- | Matches all items and returns them -}</span><span>
</span><a name="line-61"></a><span class="hs-identifier">allg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Show.Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-1627459288"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span> </span><a href="#local-1627459288"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459289"><span class="hs-identifier hs-type">st</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627459288"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-62"></a><a name="allg"><a href="Text.ParserCombinators.Parsec.Utils.html#allg" xdef=""><span class="hs-identifier">allg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.many"><span class="hs-identifier hs-var">many</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#satisfyg" xdef=""><span class="hs-identifier hs-var">satisfyg</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.True"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">{- | Matches one item not in a list and returns it. -}</span><span>
</span><a name="line-65"></a><span class="hs-identifier">noneOfg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-1627459286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Show.Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-1627459286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627459286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span> </span><a href="#local-1627459286"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459287"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627459286"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-66"></a><a name="noneOfg"><a href="Text.ParserCombinators.Parsec.Utils.html#noneOfg" xdef=""><span class="hs-identifier">noneOfg</span></a></a><span> </span><a name="local-1627459307"><a href="#local-1627459307"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#satisfyg" xdef=""><span class="hs-identifier hs-var">satisfyg</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627459308"><a href="#local-1627459308"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.not"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:Data.Foldable.elem"><span class="hs-identifier hs-var">elem</span></a><span> </span><a href="#local-1627459308"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627459307"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">{- | Matches one specific token and returns it. -}</span><span>
</span><a name="line-69"></a><span class="hs-identifier">specificg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-1627459284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Show.Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-1627459284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627459284"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#GeneralizedTokenParser" xdef=""><span class="hs-identifier hs-type">GeneralizedTokenParser</span></a><span> </span><a href="#local-1627459284"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459285"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627459284"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-70"></a><a name="specificg"><a href="Text.ParserCombinators.Parsec.Utils.html#specificg" xdef=""><span class="hs-identifier">specificg</span></a></a><span> </span><a name="local-1627459309"><a href="#local-1627459309"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.Parsec.Utils.html#satisfyg" xdef=""><span class="hs-identifier hs-var">satisfyg</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.=="><span class="hs-operator hs-var">==</span></a><span> </span><a href="#local-1627459309"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.&lt;?&gt;"><span class="hs-operator hs-var">&lt;?&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Show.show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627459309"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">{- Matches a list of tokens and returns it. -}</span><span>
</span><a name="line-73"></a><span class="hs-comment">{-
listg :: (Eq a, Show a) =&gt; [GeneralizedToken a] -&gt; GeneralizedTokenParser a st [GeneralizedToken a]
listg l = tokens (show . map fst) nextpos l
          where
          tokpos = fst
          nextpos
          nextposs _ _ (tok:toks) = tokpos tok
          nextposs _ tok [] = tokpos tok
          nextpos pos x = nextposs pos [x]
-}</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">{- | Running @notMatching p msg@ will try to apply parser p.
If it fails, returns ().  If it succeds, cause a failure and raise
the given error message.  It will not consume input in either case. -}</span><span>
</span><a name="line-87"></a><span class="hs-identifier">notMatching</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627459281"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459282"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627459283"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627459281"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627459282"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><a name="notMatching"><a href="Text.ParserCombinators.Parsec.Utils.html#notMatching" xdef=""><span class="hs-identifier">notMatching</span></a></a><span> </span><a name="local-1627459310"><a href="#local-1627459310"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627459311"><a href="#local-1627459311"><span class="hs-identifier">errormsg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1627459312"><a href="#local-1627459312"><span class="hs-identifier">maybeRead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.ParserCombinators.Parsec.Prim.try"><span class="hs-identifier hs-var">try</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span>
</span><a name="line-90"></a><span>                         </span><a name="local-1627459314"><a href="#local-1627459314"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627459310"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-91"></a><span>                         </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Base.Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627459314"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>                        </span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>                    </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.&lt;|&gt;"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-94"></a><span>        </span><a name="local-1627459313"><a href="#local-1627459313"><span class="hs-identifier">workerFunc</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-95"></a><span>                      </span><a name="local-1627459315"><a href="#local-1627459315"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627459312"><span class="hs-identifier hs-var">maybeRead</span></a><span>
</span><a name="line-96"></a><span>                      </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627459315"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-97"></a><span>                             </span><a xdef="imported from Prelude" xref="base:GHC.Base.Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>                             </span><a xdef="imported from Prelude" xref="base:GHC.Base.Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.unexpected"><span class="hs-identifier hs-var">unexpected</span></a><span> </span><a href="#local-1627459311"><span class="hs-identifier hs-var">errormsg</span></a><span>
</span><a name="line-99"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-100"></a><span>        </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.ParserCombinators.Parsec.Prim.try"><span class="hs-identifier hs-var">try</span></a><span> </span><a href="#local-1627459313"><span class="hs-identifier hs-var">workerFunc</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a></pre></body></html>