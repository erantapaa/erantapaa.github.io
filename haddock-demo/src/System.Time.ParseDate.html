<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
   Module      : System.Time.ParseDate
   Copyright   : (c) by Bj&#246;rn Bringert
   License     : GPL2

   Maintainer  : Bj&#246;rn Bringert
   Stability   : provisional
   Portability : portable

Utility for parsing dates.
-}</span><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">ParseDate</span><span> </span><span class="hs-special">(</span><a href="System.Time.ParseDate.html#parseCalendarTime" xdef=""><span class="hs-identifier hs-var">parseCalendarTime</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><a xdef="imported from Control.Monad" xref="base:GHC.Base.liftM"><span class="hs-identifier hs-var">liftM</span></a><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span> </span><span class="hs-special">(</span><a xdef="imported from Data.Char" xref="base:GHC.Unicode.isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Locale</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">ParserCombinators</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">{- | Parse a date string as formatted by 'formatCalendarTime'.

   The resulting 'CalendarTime' will only have those fields set that
   are represented by a format specifier in the format string, and those
   fields will be set to the values given in the date string.
   If the same field is specified multiple times, the rightmost
   occurence takes precedence.

   The resulting date is not neccessarily a valid date. For example,
   if there is no day of the week specifier in the format string,
   the value of 'ctWDay' will most likely be invalid.

   Format specifiers are % followed by some character. All other
   characters are treated literally. Whitespace in the format string
   matches zero or more arbitrary whitespace characters.

   Format specifiers marked with * are matched, but do not set any
   field in the output.

   Some of the format specifiers are marked as space-padded or
   zero-padded. Regardless of this, space-padded, zero-padded
   or unpadded inputs are accepted. Note that strings using
   unpadded fields without separating the fields may cause
   strange parsing.

   Supported format specfiers:

    [%%]   a % character.

    [%a]   locale's abbreviated weekday name (Sun ... Sat)

    [%A]   locale's full weekday name (Sunday .. Saturday)

    [%b]   locale's abbreviated month name (Jan..Dec)

    [%B]   locale's full month name (January..December)

    [%c]   locale's date and time format (Thu Mar 25 17:47:03 CET 2004)

    [%C]   century [00-99]

    [%d]   day of month, zero padded (01..31)

    [%D]   date (%m\/%d\/%y)

    [%e]   day of month, space padded ( 1..31)

    [%h]   same as %b

    [%H]   hour, 24-hour clock, zero padded (00..23)

    [%I]   hour, 12-hour clock, zero padded (01..12)

    [%j]   day of the year, zero padded (001..366)

    [%k]   hour, 24-hour clock, space padded ( 0..23)

    [%l]   hour, 12-hour clock, space padded ( 1..12)

    [%m]   month, zero padded (01..12)

    [%M]   minute, zero padded (00..59)

    [%n]   a newline character

    [%p]   locale's AM or PM indicator

    [%r]   locale's 12-hour time format (hh:mm:ss AM\/PM)

    [%R]   hours and minutes, 24-hour clock (hh:mm)

    [%s]   * seconds since '00:00:00 1970-01-01 UTC'

    [%S]   seconds, zero padded (00..59)

    [%t]   a horizontal tab character

    [%T]   time, 24-hour clock (hh:mm:ss)

    [%u]   numeric day of the week (1=Monday, 7=Sunday)

    [%U]   * week number, weeks starting on Sunday, zero padded (01-53)

    [%V]   * week number (as per ISO-8601),
             week 1 is the first week with a Thursday,
             zero padded, (01-53)

    [%w]   numeric day of the week, (0=Sunday, 6=Monday)

    [%W]   * week number, weeks starting on Monday, zero padded (01-53)

    [%x]   locale's preferred way of printing dates (%m\/%d\/%y)

    [%X]   locale's preferred way of printing time. (%H:%M:%S)

    [%y]   year, within century, zero padded (00..99)

    [%Y]   year, including century. Not padded
           (this is probably a bug, but formatCalendarTime does
           it this way). (0-9999)

    [%Z]   time zone abbreviation (e.g. CET) or RFC-822 style numeric
           timezone (-0500) -}</span><span>
</span><a name="line-123"></a><span class="hs-identifier">parseCalendarTime</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-124"></a><span>    </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.TimeLocale"><span class="hs-identifier hs-type">TimeLocale</span></a><span>            </span><span class="hs-comment">-- ^ Time locale</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span>             </span><span class="hs-comment">-- ^ Date format</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span>             </span><span class="hs-comment">-- ^ String to parse</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-comment">-- ^ 'Nothing' if parsing failed.</span><span>
</span><a name="line-128"></a><a name="parseCalendarTime"><a href="System.Time.ParseDate.html#parseCalendarTime" xdef=""><span class="hs-identifier">parseCalendarTime</span></a></a><span> </span><a name="local-1627445674"><a href="#local-1627445674"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627445675"><a href="#local-1627445675"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-1627445676"><a href="#local-1627445676"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.ParserCombinators.Parsec.Prim.runParser"><span class="hs-identifier hs-var">runParser</span></a><span> </span><a href="#local-1627445677"><span class="hs-identifier hs-var">parser</span></a><span> </span><a href="System.Time.ParseDate.html#epoch" xdef=""><span class="hs-identifier hs-var">epoch</span></a><span> </span><span class="hs-string">&quot;&lt;date string&gt;&quot;</span><span> </span><a href="#local-1627445676"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-130"></a><span>         </span><a xdef="imported from Prelude" xref="base:Data.Either.Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-131"></a><span>         </span><a xdef="imported from Prelude" xref="base:Data.Either.Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-1627446027"><a href="#local-1627446027"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627446027"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-132"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1627445677"><a href="#local-1627445677"><span class="hs-identifier">parser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#pCalendarTime" xdef=""><span class="hs-identifier hs-var">pCalendarTime</span></a><span> </span><a href="#local-1627445674"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627445675"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.getState"><span class="hs-identifier hs-var">getState</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- FIXME: verify input</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- FIXME: years outside 1000-9999 probably don't work</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- FIXME: what about extra whitespace in input?</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- FIXME: set ctYDay</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- FIXME: set ctIsDST</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- FIXME: missing formats from GNU date(1):</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- %F     same as %Y-%m-%d</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- %g     the 2-digit year corresponding to the %V week number</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- %G     the 4-digit year corresponding to the %V week number</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- %N     nanoseconds (000000000..999999999)</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- %P     locale's lower case am or pm indicator (blank in many locales)</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- %z     RFC-822 style numeric timezone (-0500) (a nonstandard extension)</span><span>
</span><a name="line-146"></a><span class="hs-identifier">pCalendarTime</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.TimeLocale"><span class="hs-identifier hs-type">TimeLocale</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><a name="pCalendarTime"><a href="System.Time.ParseDate.html#pCalendarTime" xdef=""><span class="hs-identifier">pCalendarTime</span></a></a><span> </span><a name="local-1627446028"><a href="#local-1627446028"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627446029"><a href="#local-1627446029"><span class="hs-identifier">fmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><a href="#local-1627446029"><span class="hs-identifier hs-var">fmt</span></a><span>
</span><a name="line-148"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-comment">-- not padded</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-comment">-- FIXME: implement</span><span>
</span><a name="line-151"></a><span>    </span><a name="local-1627446030"><a href="#local-1627446030"><span class="hs-identifier">doFmt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-char">'%'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a name="local-1627446032"><a href="#local-1627446032"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-special">(</span><span class="hs-char">'%'</span><span class="hs-glyph">:</span><a href="#local-1627446032"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-comment">-- space padded</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-comment">-- FIXME: implement</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">doFmt</span><span> </span><span class="hs-special">(</span><span class="hs-char">'%'</span><span class="hs-glyph">:</span><span class="hs-char">'_'</span><span class="hs-glyph">:</span><a name="local-1627446033"><a href="#local-1627446033"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-special">(</span><span class="hs-char">'%'</span><span class="hs-glyph">:</span><a href="#local-1627446033"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">doFmt</span><span> </span><span class="hs-special">(</span><span class="hs-char">'%'</span><span class="hs-glyph">:</span><a name="local-1627446034"><a href="#local-1627446034"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-1627446035"><a href="#local-1627446035"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446031"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-1627446034"><span class="hs-identifier hs-var">c</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><a href="#local-1627446035"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-156"></a><span>    </span><span class="hs-identifier">doFmt</span><span> </span><span class="hs-special">(</span><a name="local-1627446036"><a href="#local-1627446036"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-1627446037"><a href="#local-1627446037"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><a href="#local-1627446036"><span class="hs-identifier hs-var">c</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><a href="#local-1627446037"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-157"></a><span>    </span><span class="hs-identifier">doFmt</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>    </span><a name="local-1627446031"><a href="#local-1627446031"><span class="hs-identifier">decode</span></a></a><span> </span><span class="hs-char">'%'</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'%'</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'a'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Time.ParseDate.html#parseEnum" xdef=""><span class="hs-identifier hs-var">parseEnum</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.map"><span class="hs-identifier hs-var">map</span></a><span> </span><a xdef="imported from Prelude" xref="base:Data.Tuple.snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.wDays"><span class="hs-identifier hs-var">wDays</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setWDay" xdef=""><span class="hs-identifier hs-var">setWDay</span></a><span>
</span><a name="line-161"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'A'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Time.ParseDate.html#parseEnum" xdef=""><span class="hs-identifier hs-var">parseEnum</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.map"><span class="hs-identifier hs-var">map</span></a><span> </span><a xdef="imported from Prelude" xref="base:Data.Tuple.fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.wDays"><span class="hs-identifier hs-var">wDays</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setWDay" xdef=""><span class="hs-identifier hs-var">setWDay</span></a><span>
</span><a name="line-162"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'b'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Time.ParseDate.html#parseEnum" xdef=""><span class="hs-identifier hs-var">parseEnum</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.map"><span class="hs-identifier hs-var">map</span></a><span> </span><a xdef="imported from Prelude" xref="base:Data.Tuple.snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.months"><span class="hs-identifier hs-var">months</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setMonth" xdef=""><span class="hs-identifier hs-var">setMonth</span></a><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'B'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Time.ParseDate.html#parseEnum" xdef=""><span class="hs-identifier hs-var">parseEnum</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.map"><span class="hs-identifier hs-var">map</span></a><span> </span><a xdef="imported from Prelude" xref="base:Data.Tuple.fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.months"><span class="hs-identifier hs-var">months</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setMonth" xdef=""><span class="hs-identifier hs-var">setMonth</span></a><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'c'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.dateTimeFmt"><span class="hs-identifier hs-var">dateTimeFmt</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'C'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627446139"><a href="#local-1627446139"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Time.ParseDate.html#updateYear" xdef=""><span class="hs-identifier hs-var">updateYear</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446140"><a href="#local-1627446140"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446139"><span class="hs-identifier hs-var">c</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.*"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">100</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.+"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1627446140"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a xdef="imported from Prelude" xref="base:GHC.Real.rem"><span class="hs-identifier hs-var">rem</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'d'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627446141"><a href="#local-1627446141"><span class="hs-identifier">day</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627446141"><span class="hs-identifier hs-var">day</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.&gt;"><span class="hs-operator hs-var">&gt;</span></a><span> </span><span class="hs-number">31</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.||"><span class="hs-operator hs-var">||</span></a><span> </span><a href="#local-1627446141"><span class="hs-identifier hs-var">day</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.&lt;"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-167"></a><span>                                       </span><span class="hs-keyword">then</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.fail"><span class="hs-identifier hs-var">fail</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-string">&quot;Invalid day &quot;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.++"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Show.show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627446141"><span class="hs-identifier hs-var">day</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>                                       </span><span class="hs-keyword">else</span><span> </span><a href="System.Time.ParseDate.html#setDay" xdef=""><span class="hs-identifier hs-var">setDay</span></a><span> </span><a href="#local-1627446141"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'D'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-string">&quot;%m/%d/%y&quot;</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'e'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setDay" xdef=""><span class="hs-identifier hs-var">setDay</span></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'h'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446031"><span class="hs-identifier hs-var">decode</span></a><span> </span><span class="hs-char">'b'</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'H'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setHour" xdef=""><span class="hs-identifier hs-var">setHour</span></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'I'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setHour12" xdef=""><span class="hs-identifier hs-var">setHour12</span></a><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'j'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read3" xdef=""><span class="hs-identifier hs-var">read3</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setYDay" xdef=""><span class="hs-identifier hs-var">setYDay</span></a><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'k'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setHour" xdef=""><span class="hs-identifier hs-var">setHour</span></a><span>
</span><a name="line-176"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'l'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setHour12" xdef=""><span class="hs-identifier hs-var">setHour12</span></a><span>
</span><a name="line-177"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'m'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627446142"><a href="#local-1627446142"><span class="hs-identifier">mon</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-1627446142"><span class="hs-identifier hs-var">mon</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.&gt;"><span class="hs-operator hs-var">&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Enum.fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Enum.maxBound"><span class="hs-identifier hs-var">maxBound</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.Month"><span class="hs-identifier hs-type">Month</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>                                      </span><span class="hs-keyword">then</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.fail"><span class="hs-identifier hs-var">fail</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.$"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-string">&quot;Invalid month &quot;</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.++"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Show.show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-1627446142"><span class="hs-identifier hs-var">mon</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>                                      </span><span class="hs-keyword">else</span><span> </span><a href="System.Time.ParseDate.html#setMonth" xdef=""><span class="hs-identifier hs-var">setMonth</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Enum.toEnum"><span class="hs-identifier hs-var">toEnum</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627446142"><span class="hs-identifier hs-var">mon</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'M'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setMin" xdef=""><span class="hs-identifier hs-var">setMin</span></a><span>
</span><a name="line-181"></a><span>    </span><span class="hs-comment">-- FIXME: strptime(3) accepts &quot;arbitrary whitespace&quot; for %n</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'n'</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'\n'</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'p'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-184"></a><span>                 </span><a name="local-1627446145"><a href="#local-1627446145"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.string"><span class="hs-identifier hs-var">string</span></a><span> </span><a href="#local-1627446143"><span class="hs-identifier hs-var">am</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.&lt;|&gt;"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.string"><span class="hs-identifier hs-var">string</span></a><span> </span><a href="#local-1627446144"><span class="hs-identifier hs-var">pm</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>                 </span><a href="System.Time.ParseDate.html#updateHour" xdef=""><span class="hs-identifier hs-var">updateHour</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446146"><a href="#local-1627446146"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446145"><span class="hs-identifier hs-var">x</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.+"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1627446146"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a xdef="imported from Prelude" xref="base:GHC.Real.rem"><span class="hs-identifier hs-var">rem</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-1627446143"><a href="#local-1627446143"><span class="hs-identifier">am</span></a></a><span class="hs-special">,</span><a name="local-1627446144"><a href="#local-1627446144"><span class="hs-identifier">pm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.amPm"><span class="hs-identifier hs-var">amPm</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-187"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'r'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.time12Fmt"><span class="hs-identifier hs-var">time12Fmt</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'R'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-string">&quot;%H:%M&quot;</span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-comment">-- FIXME: implement %s.</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-comment">-- FIXME: implement %s in formatCalendarTime</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'s'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#int" xdef=""><span class="hs-identifier hs-var">int</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'S'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setSec" xdef=""><span class="hs-identifier hs-var">setSec</span></a><span>
</span><a name="line-193"></a><span>    </span><span class="hs-comment">-- FIXME: strptime(3) accepts &quot;arbitrary whitespace&quot; for %t</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'t'</span><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'\t'</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'T'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-string">&quot;%H:%M:%S&quot;</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'u'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#readN" xdef=""><span class="hs-identifier hs-var">readN</span></a><span> </span><span class="hs-number">1</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setWDay" xdef=""><span class="hs-identifier hs-var">setWDay</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.."><span class="hs-operator hs-var">.</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Enum.toEnum"><span class="hs-identifier hs-var">toEnum</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446147"><a href="#local-1627446147"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627446147"><span class="hs-identifier hs-var">w</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.=="><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">7</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-1627446147"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-comment">-- FIXME: implement %U.</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'U'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-comment">-- FIXME: implement %V.</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'V'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'w'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#readN" xdef=""><span class="hs-identifier hs-var">readN</span></a><span> </span><span class="hs-number">1</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setWDay" xdef=""><span class="hs-identifier hs-var">setWDay</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.."><span class="hs-operator hs-var">.</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Enum.toEnum"><span class="hs-identifier hs-var">toEnum</span></a><span>
</span><a name="line-202"></a><span>    </span><span class="hs-comment">-- FIXME: implement %W.</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'W'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'x'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.dateFmt"><span class="hs-identifier hs-var">dateFmt</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'X'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446030"><span class="hs-identifier hs-var">doFmt</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.Locale" xref="oldlo_D6X1KPq5Sui5XjrHMwvFwK:System.Locale.timeFmt"><span class="hs-identifier hs-var">timeFmt</span></a><span> </span><a href="#local-1627446028"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-comment">-- FIXME: should probably be zero padded,</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-comment">--        need to change formatCalendarTime too</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'Y'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#int" xdef=""><span class="hs-identifier hs-var">int</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setYear" xdef=""><span class="hs-identifier hs-var">setYear</span></a><span>
</span><a name="line-209"></a><span>    </span><span class="hs-comment">-- FIXME: maybe 04 should be 2004, not 1904?</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'y'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-1627446148"><a href="#local-1627446148"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Time.ParseDate.html#updateYear" xdef=""><span class="hs-identifier hs-var">updateYear</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446149"><a href="#local-1627446149"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627446149"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a xdef="imported from Prelude" xref="base:GHC.Real.quot"><span class="hs-identifier hs-var">quot</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.*"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">100</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.+"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1627446148"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-comment">-- FIXME: are timezone names always [A-Z]+ ?</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-comment">-- FIXME: set ctTZ when parsing timezone name and</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-comment">--        ctTZName when parsing offset</span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><span class="hs-char">'Z'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446150"><span class="hs-identifier hs-var">tzname</span></a><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.&lt;|&gt;"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-1627446151"><span class="hs-identifier hs-var">tzoffset</span></a><span>
</span><a name="line-215"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-1627446150"><a href="#local-1627446150"><span class="hs-identifier">tzname</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Combinator.many1"><span class="hs-identifier hs-var">many1</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.oneOf"><span class="hs-identifier hs-var">oneOf</span></a><span> </span><span class="hs-special">[</span><span class="hs-char">'A'</span><span class="hs-glyph">..</span><span class="hs-char">'Z'</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;="><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="System.Time.ParseDate.html#setTZName" xdef=""><span class="hs-identifier hs-var">setTZName</span></a><span>
</span><a name="line-216"></a><span>              </span><a name="local-1627446151"><a href="#local-1627446151"><span class="hs-identifier">tzoffset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-217"></a><span>                         </span><a name="local-1627446276"><a href="#local-1627446276"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Time.ParseDate.html#sign" xdef=""><span class="hs-identifier hs-var">sign</span></a><span>
</span><a name="line-218"></a><span>                         </span><a name="local-1627446277"><a href="#local-1627446277"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span>
</span><a name="line-219"></a><span>                         </span><a name="local-1627446278"><a href="#local-1627446278"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier hs-var">read2</span></a><span>
</span><a name="line-220"></a><span>                         </span><a href="System.Time.ParseDate.html#setTZ" xdef=""><span class="hs-identifier hs-var">setTZ</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627446276"><span class="hs-identifier hs-var">s</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.*"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627446277"><span class="hs-identifier hs-var">h</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.*"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">3600</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.+"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1627446278"><span class="hs-identifier hs-var">m</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.*"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">60</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-comment">-- following the example of strptime(3),</span><span>
</span><a name="line-222"></a><span>    </span><span class="hs-comment">-- whitespace matches zero or more whitespace</span><span>
</span><a name="line-223"></a><span>    </span><span class="hs-comment">-- characters in the input string</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><a name="local-1627446279"><a href="#local-1627446279"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a xdef="imported from Data.Char" xref="base:GHC.Unicode.isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-1627446279"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.spaces"><span class="hs-identifier hs-var">spaces</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>    </span><span class="hs-identifier">decode</span><span> </span><a name="local-1627446300"><a href="#local-1627446300"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><a href="#local-1627446300"><span class="hs-identifier hs-var">c</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-identifier">epoch</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span>
</span><a name="line-228"></a><a name="epoch"><a href="System.Time.ParseDate.html#epoch" xdef=""><span class="hs-identifier">epoch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-var">CalendarTime</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-229"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctYear"><span class="hs-identifier hs-var">ctYear</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1970</span><span class="hs-special">,</span><span>
</span><a name="line-230"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctMonth"><span class="hs-identifier hs-var">ctMonth</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.January"><span class="hs-identifier hs-var">January</span></a><span class="hs-special">,</span><span>
</span><a name="line-231"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctDay"><span class="hs-identifier hs-var">ctDay</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span>
</span><a name="line-232"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctHour"><span class="hs-identifier hs-var">ctHour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-233"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctMin"><span class="hs-identifier hs-var">ctMin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-234"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctSec"><span class="hs-identifier hs-var">ctSec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-235"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctPicosec"><span class="hs-identifier hs-var">ctPicosec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-236"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctWDay"><span class="hs-identifier hs-var">ctWDay</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.Thursday"><span class="hs-identifier hs-var">Thursday</span></a><span class="hs-special">,</span><span>
</span><a name="line-237"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctYDay"><span class="hs-identifier hs-var">ctYDay</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span>
</span><a name="line-238"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctTZName"><span class="hs-identifier hs-var">ctTZName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;UTC&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-239"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctTZ"><span class="hs-identifier hs-var">ctTZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-240"></a><span>                      </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctIsDST"><span class="hs-identifier hs-var">ctIsDST</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-241"></a><span>                     </span><span class="hs-special">}</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-identifier">parseEnum</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Enum.Enum"><span class="hs-identifier hs-type">Enum</span></a><span> </span><a href="#local-1627445672"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.ParserCombinators.Parsec.Char.CharParser"><span class="hs-identifier hs-type">CharParser</span></a><span> </span><a href="#local-1627445671"><span class="hs-identifier hs-type">st</span></a><span> </span><a href="#local-1627445672"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-244"></a><a name="parseEnum"><a href="System.Time.ParseDate.html#parseEnum" xdef=""><span class="hs-identifier">parseEnum</span></a></a><span> </span><a name="local-1627446301"><a href="#local-1627446301"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Combinator.choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.List.zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><a href="#local-1627446302"><span class="hs-identifier hs-var">tryString</span></a><span> </span><a href="#local-1627446301"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Enum.enumFrom"><span class="hs-identifier hs-var">enumFrom</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="base:GHC.Enum.toEnum"><span class="hs-identifier hs-var">toEnum</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1627446302"><a href="#local-1627446302"><span class="hs-identifier">tryString</span></a></a><span> </span><a name="local-1627446303"><a href="#local-1627446303"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1627446304"><a href="#local-1627446304"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.ParserCombinators.Parsec.Prim.try"><span class="hs-identifier hs-var">try</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.string"><span class="hs-identifier hs-var">string</span></a><span> </span><a href="#local-1627446303"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627446304"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-identifier">setYear</span><span class="hs-special">,</span><span class="hs-identifier">setDay</span><span class="hs-special">,</span><span class="hs-identifier">setHour</span><span class="hs-special">,</span><span class="hs-identifier">setHour12</span><span class="hs-special">,</span><span class="hs-identifier">setMin</span><span class="hs-special">,</span><span class="hs-identifier">setSec</span><span class="hs-special">,</span><span class="hs-identifier">setYDay</span><span class="hs-special">,</span><span class="hs-identifier">setTZ</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627445670"><span class="hs-identifier hs-type">tok</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><a name="setYear"><a href="System.Time.ParseDate.html#setYear" xdef=""><span class="hs-identifier">setYear</span></a></a><span> </span><a name="local-1627446305"><a href="#local-1627446305"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446306"><a href="#local-1627446306"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446306"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctYear"><span class="hs-identifier hs-var">ctYear</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446305"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span class="hs-identifier">setMonth</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.Month"><span class="hs-identifier hs-type">Month</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627445669"><span class="hs-identifier hs-type">tok</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><a name="setMonth"><a href="System.Time.ParseDate.html#setMonth" xdef=""><span class="hs-identifier">setMonth</span></a></a><span> </span><a name="local-1627446307"><a href="#local-1627446307"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446308"><a href="#local-1627446308"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446308"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctMonth"><span class="hs-identifier hs-var">ctMonth</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446307"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><a name="setDay"><a href="System.Time.ParseDate.html#setDay" xdef=""><span class="hs-identifier">setDay</span></a></a><span> </span><a name="local-1627446309"><a href="#local-1627446309"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446310"><a href="#local-1627446310"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446310"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctDay"><span class="hs-identifier hs-var">ctDay</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446309"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-252"></a><a name="setHour"><a href="System.Time.ParseDate.html#setHour" xdef=""><span class="hs-identifier">setHour</span></a></a><span> </span><a name="local-1627446311"><a href="#local-1627446311"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446312"><a href="#local-1627446312"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446312"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctHour"><span class="hs-identifier hs-var">ctHour</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446311"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><a name="setMin"><a href="System.Time.ParseDate.html#setMin" xdef=""><span class="hs-identifier">setMin</span></a></a><span> </span><a name="local-1627446313"><a href="#local-1627446313"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446314"><a href="#local-1627446314"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446314"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctMin"><span class="hs-identifier hs-var">ctMin</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446313"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-254"></a><a name="setSec"><a href="System.Time.ParseDate.html#setSec" xdef=""><span class="hs-identifier">setSec</span></a></a><span> </span><a name="local-1627446315"><a href="#local-1627446315"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446316"><a href="#local-1627446316"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446316"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctSec"><span class="hs-identifier hs-var">ctSec</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446315"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span class="hs-identifier">setWDay</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.Day"><span class="hs-identifier hs-type">Day</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627445668"><span class="hs-identifier hs-type">tok</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><a name="setWDay"><a href="System.Time.ParseDate.html#setWDay" xdef=""><span class="hs-identifier">setWDay</span></a></a><span> </span><a name="local-1627446317"><a href="#local-1627446317"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446318"><a href="#local-1627446318"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446318"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctWDay"><span class="hs-identifier hs-var">ctWDay</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446317"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><a name="setYDay"><a href="System.Time.ParseDate.html#setYDay" xdef=""><span class="hs-identifier">setYDay</span></a></a><span> </span><a name="local-1627446319"><a href="#local-1627446319"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446320"><a href="#local-1627446320"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446320"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctYDay"><span class="hs-identifier hs-var">ctYDay</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446319"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span class="hs-identifier">setTZName</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627445667"><span class="hs-identifier hs-type">tok</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-259"></a><a name="setTZName"><a href="System.Time.ParseDate.html#setTZName" xdef=""><span class="hs-identifier">setTZName</span></a></a><span> </span><a name="local-1627446321"><a href="#local-1627446321"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446322"><a href="#local-1627446322"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446322"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctTZName"><span class="hs-identifier hs-var">ctTZName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446321"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-260"></a><a name="setTZ"><a href="System.Time.ParseDate.html#setTZ" xdef=""><span class="hs-identifier">setTZ</span></a></a><span> </span><a name="local-1627446323"><a href="#local-1627446323"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446324"><a href="#local-1627446324"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446324"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctTZ"><span class="hs-identifier hs-var">ctTZ</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446323"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-identifier">updateYear</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627445666"><span class="hs-identifier hs-type">tok</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-263"></a><a name="updateYear"><a href="System.Time.ParseDate.html#updateYear" xdef=""><span class="hs-identifier">updateYear</span></a></a><span> </span><a name="local-1627446325"><a href="#local-1627446325"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446326"><a href="#local-1627446326"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446326"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctYear"><span class="hs-identifier hs-var">ctYear</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446325"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctYear"><span class="hs-identifier hs-var">ctYear</span></a><span> </span><a href="#local-1627446326"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span class="hs-identifier">updateHour</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a href="#local-1627445665"><span class="hs-identifier hs-type">tok</span></a><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.CalendarTime"><span class="hs-identifier hs-type">CalendarTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-265"></a><a name="updateHour"><a href="System.Time.ParseDate.html#updateHour" xdef=""><span class="hs-identifier">updateHour</span></a></a><span> </span><a name="local-1627446327"><a href="#local-1627446327"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.updateState"><span class="hs-identifier hs-var">updateState</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446328"><a href="#local-1627446328"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627446328"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">{</span><span> </span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctHour"><span class="hs-identifier hs-var">ctHour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627446327"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from System.Time" xref="oldti_FBWJJDS5FKr7UKFScBcUW2:System.Time.ctHour"><span class="hs-identifier hs-var">ctHour</span></a><span> </span><a href="#local-1627446328"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><a name="setHour12"><a href="System.Time.ParseDate.html#setHour12" xdef=""><span class="hs-identifier">setHour12</span></a></a><span> </span><a name="local-1627446329"><a href="#local-1627446329"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#updateHour" xdef=""><span class="hs-identifier hs-var">updateHour</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627446332"><a href="#local-1627446332"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627446332"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a xdef="imported from Prelude" xref="base:GHC.Real.quot"><span class="hs-identifier hs-var">quot</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.*"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">12</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Num.+"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-1627446330"><span class="hs-identifier hs-var">from12</span></a><span> </span><a href="#local-1627446329"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1627446330"><a href="#local-1627446330"><span class="hs-identifier">from12</span></a></a><span> </span><a name="local-1627446331"><a href="#local-1627446331"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627446331"><span class="hs-identifier hs-var">h</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Classes.=="><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">12</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-1627446331"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-identifier">read2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">read3</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><a href="#local-1627445664"><span class="hs-identifier hs-type">st</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-271"></a><a name="read2"><a href="System.Time.ParseDate.html#read2" xdef=""><span class="hs-identifier">read2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#readN" xdef=""><span class="hs-identifier hs-var">readN</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-272"></a><a name="read3"><a href="System.Time.ParseDate.html#read3" xdef=""><span class="hs-identifier">read3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.ParseDate.html#readN" xdef=""><span class="hs-identifier hs-var">readN</span></a><span> </span><span class="hs-number">3</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- | Read up to a given number of digits, optionally left-padded</span><span>
</span><a name="line-275"></a><span class="hs-comment">--   with whitespace and interpret them as an 'Int'.</span><span>
</span><a name="line-276"></a><span class="hs-identifier">readN</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><a href="#local-1627445663"><span class="hs-identifier hs-type">st</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-277"></a><a name="readN"><a href="System.Time.ParseDate.html#readN" xdef=""><span class="hs-identifier">readN</span></a></a><span> </span><a name="local-1627446333"><a href="#local-1627446333"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-278"></a><span>    </span><a xdef="imported from Control.Monad" xref="base:GHC.Base.liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><a xdef="imported from Prelude" xref="base:Text.Read.read"><span class="hs-identifier hs-var">read</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.spaces"><span class="hs-identifier hs-var">spaces</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Combinator.choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><span class="hs-special">[</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.ParserCombinators.Parsec.Prim.try"><span class="hs-identifier hs-var">try</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Combinator.count"><span class="hs-identifier hs-var">count</span></a><span> </span><a href="#local-1627446350"><span class="hs-identifier hs-var">m</span></a><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.digit"><span class="hs-identifier hs-var">digit</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1627446350"><a href="#local-1627446350"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-1627446333"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><a href="#local-1627446333"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-identifier">int</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><a href="#local-1627445662"><span class="hs-identifier hs-type">st</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-281"></a><a name="int"><a href="System.Time.ParseDate.html#int" xdef=""><span class="hs-identifier">int</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a xdef="imported from Control.Monad" xref="base:GHC.Base.liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><a xdef="imported from Prelude" xref="base:Text.Read.read"><span class="hs-identifier hs-var">read</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Combinator.many1"><span class="hs-identifier hs-var">many1</span></a><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.digit"><span class="hs-identifier hs-var">digit</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-identifier">sign</span><span> </span><span class="hs-glyph">::</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.String.GenParser"><span class="hs-identifier hs-type">GenParser</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><a href="#local-1627445648"><span class="hs-identifier hs-type">st</span></a><span> </span><a xdef="imported from Prelude" xref="ghc-prim:GHC.Types.Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-284"></a><a name="sign"><a href="System.Time.ParseDate.html#sign" xdef=""><span class="hs-identifier">sign</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'+'</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Prim.&lt;|&gt;"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><span class="hs-special">(</span><a xdef="imported from Text.ParserCombinators.Parsec" xref="parse_GcNjd7VwUPzL59CD2aY0V6:Text.Parsec.Char.char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'-'</span><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.&gt;&gt;"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a xdef="imported from Prelude" xref="base:GHC.Base.return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a></pre></body></html>